<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人主页</title>
  	<link rel="stylesheet" href="https://cdn.staticfile.net/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://cdn.staticfile.net/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.net/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="personal.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
    <link rel="stylesheet" href="personnal.css">

</head>
    <style>
    </style>
</head>
<body oncontextmenu="return false;" onselectstart="return false;" unselectable="on" ondragstart="return false;">
    <!-- 弹出框 -->
<div id="myModal" class="modal_text">
    <div class="modal-content">
        <input type="text" placeholder="Enter motto here..." name="motto">
        <input type="text" placeholder="Enter name here..." name="name">
        <input type="text" placeholder="Enter gender here..." name="gender">
        <button class="btn cancel-btn" onclick="closeModal()">Cancel</button>
        <button class="btn close-btn" onclick="closeModal()">Confirm</button>
    </div>
</div>

<div id="myModal_icon" class="modal-icon">
    <div class="modal-icon-content">
        <button class="close-icon-btn" onclick="closeModal_icon()">&times;</button>
        <h2>choose your image and cut it</h2>
        <div class="avatar-container">
            <img id="avatarImg" src="#" alt="Avatar Preview">
        </div>
        <input type="file" id="imageInput" accept="image/*" style="display:none;">
        <button class="icon-btn open-btn" onclick="openFilePicker()">Open Image</button>
        <button class="icon-btn confirm-btn" onclick="confirmChanges()">Confirm Changes</button>
    </div>
</div>

<aside>

    <div class="pagination-dots">
      <span class="dot active" data-index="0"></span>
      <span class="dot" data-index="1"></span>
      <span class="dot" data-index="2"></span>

  </div>
</aside>

<div class="carousel">
  <div class="carousel-top">
    <br></br>
    &nbsp;
    &nbsp;
    &nbsp;
    &nbsp;
    &nbsp;
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="white" class="bi-house"  viewBox="0 0 16 16" data-toggle="tooltip"  data-placement="bottom" title="back to home" onclick="redirectToHome()">

      <path fill-rule="evenodd" d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207l-5-5-5 5V13.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7.207Z"/>
    </svg>
    &nbsp; &nbsp;
    &nbsp;
    &nbsp;
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="white" class="bi-person-up" viewBox="0 0 16 16"  data-toggle="tooltip"  data-placement="bottom" title="i want to change my image" onclick="showModal_icon()">
      <path fill-rule="evenodd" d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.354-5.854a.5.5 0 0 0-.708 0l-1.5 1.5a.5.5 0 0 0 .708.708l.646-.647V14.5a.5.5 0 0 0 1 0v-2.793l.646.647a.5.5 0 0 0 .708-.708l-1.5-1.5ZM11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/>
      <path d="M8.256 14a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Z"/>
    </svg>
    &nbsp; &nbsp;
    &nbsp;
    &nbsp;
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="white" class="bi-pen" viewBox="0 0 16 16"  data-toggle="tooltip"  data-placement="bottom" title="i want to change the text infomation" onclick="showModal()">
      <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"/>
    </svg>

  </div>

    <div class="carousel-inner">

        <section class="carousel-item page_one" id="page1">
            <div class="cen_con">
                <div class="portrait">
                    <img class="icon"  src="../person_img/none.jpg">
                </div>

                <HR  width=300 color=white SIZE=1>


                <div class="cen_text">

                    <h2 class="motto" style="color: white; text-align: center; text-size-adjust: 100%; font-size: 40px">Witness my best years with the time of a flower's reincarnation.</h2>
                    &nbsp;
                    &nbsp;
                    &nbsp;
                    <h2 class="name" style="color: white; text-align: left; font-size: medium;text-size-adjust: 100%; font-size: 20px ">• NAME: Vaguesunrain</h2>
                    <h2 class="email" style="color: white; text-align: left; font-size: medium; text-size-adjust: 100%; font-size: 20px">• EMAIL: example@gmail.com</h2>
                    <h2 class="male" style="color: white; text-align: left; font-size: medium; text-size-adjust: 100%; font-size: 20px">• GENDER: Girl/Boy</h2>
                </div>
            </div>
        </section>
        <section class="carousel-item page_two" id="page2">

                <div class="text_head">Your Blog List:</div>
                <div class="cross">
                    <div class="horizontal"></div>
                    <div class="vertical"></div>
                </div>
                <div class="text">You don't have any footprints yet. <a href="../work_space/your_edit.html">Write something now!</a></div>
                <div class="text_end"> <a href="../work_space/your_blog_manage.html">More about my blogs>> </a></div>

        </section>
        <section class="carousel-item page_three" id="page3">
            <div class="text">THIS PAGE IS EMPTY,WE HAVE NOT DESIGN IT.</div>

        </section>

    </div>
</div>
<script>
 function redirectToHome() {
            window.location.href = "../loading.html";
        }


    document.addEventListener('DOMContentLoaded', function() {
    const carouselInner = document.querySelector('.carousel-inner');
    const items = document.querySelectorAll('.carousel-item');
    const dots = document.querySelectorAll('.dot');
    const totalItems = items.length;
    let currentIndex = 0;
    function showPage(index,is_up) {
        if (is_up) {
            if (index==-1) {
                index=totalItems-1;
                items[0].style.display = 'none';
                items[index].style.display = 'flex';
            }
            else{
                items[index+1].style.display = 'none';
                items[index].style.display = 'flex';
            }
        }
        else{
            if (index==totalItems) {
                index=0;
                items[2].style.display = 'none';
                items[index].style.display = 'flex';
            }
            else if(index!=0){
                items[index-1].style.display = 'none';
                items[index].style.display = 'flex';
            }
        }

        currentIndex = index;
        updateDots();
    }

    function updateDots() {
        dots.forEach(dot => dot.classList.remove('active'));
        dots[currentIndex].classList.add('active');
    }

    function handleWheel(event) {
        if (event.deltaY < 0) {
            showPage(currentIndex - 1,true);
        } else if (event.deltaY > 0) {
            showPage(currentIndex + 1,false);
        }
    }

    function handleTouchStart(event) {
    const touchStartY = event.touches[0].clientY;
    event.target.dataset.touchStartY = touchStartY;
    console.log(touchStartY,"start y");
}

function handleTouchEnd(event) {
    const touchEndY = event.changedTouches[0].clientY;
    const touchStartY = parseFloat(event.target.dataset.touchStartY);
    const swipeThreshold = 30; // Minimum swipe distance in pixels to detect a swipe
    console.log("end y",touchEndY);
    if (touchStartY - touchEndY > swipeThreshold) {
        showPage(currentIndex - 1, true);
    } else if (touchEndY - touchStartY > swipeThreshold) {
        showPage(currentIndex + 1, false);
    }
}


    // dots.forEach(dot => {
    //     dot.addEventListener('click', () => {
    //         const index = parseInt(dot.getAttribute('data-index'));
    //         console.log(index);
    //         showPage(index);
    //     });
    // });//这部分代码使用showpage 参数不对，懒得改了，先删除了

    document.addEventListener('wheel', handleWheel);
    document.addEventListener('touchstart', handleTouchStart);
document.addEventListener('touchend', handleTouchEnd);
    // 初始化第一个页面和对应的dot
    showPage(currentIndex);
});

	$(function () { $("[data-toggle='tooltip']").tooltip(); });


var cropper;
function openFilePicker() {
    document.getElementById('imageInput').click();
}

document.getElementById('imageInput').addEventListener('change', function() {
    var file = this.files[0];
    if (file) {
        var reader = new FileReader();
        reader.onload = function(event) {
            var img = document.getElementById('avatarImg');
            img.src = event.target.result;
             // 销毁旧的 Cropper 实例（如果存在）
             if (cropper) {
                cropper.destroy();
            }
            // 初始化 Cropper.js
            cropper = new Cropper(img, {
                aspectRatio: 1, // 设置裁剪框比例为1:1，即正方形
                viewMode: 2, // 显示裁剪框的模式：限制在容器内并且不超出容器
                autoCropArea: 0.8, // 初始裁剪框大小占图像大小的比例
                movable: true,
                zoomable: true,
                rotatable: true,
                scalable: true
            });
        };
        reader.readAsDataURL(file);
    }
});

function confirmChanges() {
    if (cropper) {
        // 获取裁剪后的图像数据
        var croppedCanvas = cropper.getCroppedCanvas();
        if (croppedCanvas) {
            // 将裁剪后的图像显示在预览区域
            document.getElementById('avatarImg').src = croppedCanvas.toDataURL();
        }
        // 可以在这里处理上传等逻辑
    }

    var modal = document.getElementById('myModal');
    modal.style.display = 'none';
    alert('Changes confirmed!');
    closeModal_icon();
}

</script>
</body>
</html>
