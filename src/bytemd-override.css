/* =========================================
   Letter Editor UI (编辑模式 - 信纸风格)
   ========================================= */

/* 1. 容器：去除边框，背景透明 (让父级的信纸底色透出来) */
.bytemd {
  background-color: transparent !important;
  border: none !important;
  height: 100% !important;
  min-height: 600px;
    background-color: #FDFBF7 !important; /* 暖白信纸色，不刺眼 */
}

/* 2. 编辑区域核心 (CodeMirror) */
.CodeMirror {
  /* 字体：与阅读页保持一致 */
  font-family: "Georgia", "Times New Roman", serif !important;
  font-size: 20px !important;

  /* 【关键】行高必须固定，与背景线条严格对齐 */
  line-height: 32px !important;

  color: #2C3E50 !important;
  background: transparent !important;
  height: auto !important;
  min-height: 100%;
}

/* 3. 【核心魔法】画横线 */
/* 我们把横线画在 CodeMirror 的滚动区域背景上 */
.CodeMirror-scroll {
  /* 线性渐变画线：透明31px，灰色1px */
  background-image: linear-gradient(to bottom, transparent 31px, rgba(0, 0, 0, 0.08) 31px) !important;
  background-size: 100% 32px !important; /* 必须和 line-height 一致 */
  background-attachment: local !important; /* 让背景随文字滚动 */
  background-repeat: repeat !important;

  padding-bottom: 100px !important; /* 底部留白 */
  min-height: 600px !important;
}

/* 4. 微调文字位置，确保文字“坐”在线上 */
.CodeMirror-lines {
  padding-top: 4px !important; /* 根据字体情况微调，让字底对齐线条 */
}

/* 5. 选中状态：不要覆盖掉横线，用半透明色 */
.CodeMirror-selected {
  background: rgba(141, 123, 104, 0.2) !important; /* 暖褐色半透明 */
}

/* 6. 光标：改为暖褐色竖线 */
.CodeMirror-cursor {
  border-left: 2px solid #8D7B68 !important;
  height: 24px !important; /* 控制光标高度，不要太长戳破线条 */
}

/* 7. 工具栏：极简处理，像信纸顶部的抬头 */
.bytemd-toolbar {
  background-color: transparent !important;
  border-bottom: 2px solid #2C3E50 !important; /* 像信纸顶部的粗线 */
  margin-bottom: 20px !important;
  padding: 10px 0 !important;
}

.bytemd-toolbar-icon {
  color: #7F8C8D !important;
}
.bytemd-toolbar-icon:hover {
  background-color: rgba(0,0,0,0.05) !important;
  color: #2C3E50 !important;
}
.bytemd-toolbar-icon-active {
  color: #8D7B68 !important;
  background: transparent !important;
  font-weight: bold;
}

/* 8. 隐藏状态栏 */
.bytemd-status {
  display: none !important;
}

/* 9. 预览区域 (Split View) 的样式 */
/* 如果你开了分屏预览，让预览区也像信纸 */
.bytemd-preview {
  background-color: rgba(255, 255, 255, 0.3) !important; /* 稍微深一点区分 */
  border-left: 1px solid rgba(0,0,0,0.1) !important;
}
/* =========================================
   7. 全屏模式 (Fullscreen) - 彻底信纸模式
   ========================================= */

/* 核心容器 */
.bytemd-fullscreen {
  /* 解决穿透问题：极高层级 */
  z-index: 99999 !important;

  /* 强制固定定位，铺满全屏 */
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;

  /* 解决背景和穿透：使用实色背景 */
  background-color: #FDFBF7 !important; /* 暖白信纸色，不刺眼 */

  /* 布局调整 */
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
}

/* 全屏下的工具栏：吸顶 */
.bytemd-fullscreen .bytemd-toolbar {
  position: sticky;
  top: 0;
  z-index: 10;
  background-color: #FDFBF7 !important; /* 同背景色 */
  border-bottom: 1px solid rgba(0,0,0,0.1) !important;
  padding: 15px 40px !important; /* 加宽边距，更舒展 */
  max-width: 1000px; /* 限制宽度，防止在大屏上太散 */
  margin: 0 auto !important;
  width: 100%;
}

/* 全屏下的编辑区主体 */
.bytemd-fullscreen .bytemd-body {

  margin: 0 auto;
  height: calc(100vh - 60px) !important; /* 减去工具栏高度 */
  background-color: transparent !important;
}

/* 全屏下的 CodeMirror (编辑区) */
.bytemd-fullscreen .CodeMirror {
  padding-top: 40px !important; /* 顶部留白 */
  padding-bottom: 100px !important; /* 底部留白 */
}

/* 确保横线在全屏下依然对齐 */
.bytemd-fullscreen .CodeMirror-scroll {
  /* 保持与非全屏一致的横线逻辑 */
  background-image: linear-gradient(to bottom, transparent 31px, rgba(0, 0, 0, 0.05) 31px) !important;
  background-size: 100% 32px !important;
  background-attachment: local !important;

  /* 隐藏原生滚动条，使用浏览器默认的 */
  overflow-y: auto !important;
}

/* 修复 CodeMirror 遮挡问题 */
.bytemd-fullscreen .CodeMirror-sizer {
  margin-left: 0 !important;
  border-right: none !important;
}

/* =========================================
   Editor Preview - 代码块风格统一 (Sync with Read Page)
   ========================================= */

/* 1. 外层容器：浅灰信纸底色 */
.markdown-body pre {
    background-color: #F3F4F6 !important; /* 代码块整体底色 */
    border: 1px solid #E5E7EB !important;
    border-radius: 2px !important;
    padding: 20px !important;
    margin: 32px 0 !important;

    /* 字体设置 */
    font-family: "Courier New", Courier, monospace !important;
    font-size: 14px !important;
    line-height: 1.6 !important;
    color: #374151 !important; /* 默认文字颜色 */

    overflow-x: auto !important;
}

/* 2. 内部代码元素：强制透明，去除高亮插件的背景 */
.markdown-body pre code,
.markdown-body pre code span,
.markdown-body pre .hljs {
    background-color: transparent !important; /* 关键：去底色 */
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 !important;

    /* 3. 强制继承文字颜色，防止高亮插件把文字变白 */
    color: inherit !important;
    text-shadow: none !important;
    font-family: inherit !important;
}

/* 4. (可选) 如果你想要一点点语法高亮，但不想太花哨
      可以单独定义几个关键 token 的颜色，覆盖 highlight.js 的默认样式
      这会让代码看起来像打印出来的，而不是霓虹灯
*/
.markdown-body .hljs-keyword,
.markdown-body .hljs-selector-tag {
    color: #333 !important;
    font-weight: bold !important;
}

.markdown-body .hljs-string,
.markdown-body .hljs-attr {
    color: #555 !important;
    font-style: italic !important;
}

.markdown-body .hljs-comment {
    color: #999 !important;
    font-style: italic !important;
}

.markdown-body .hljs-number,
.markdown-body .hljs-literal {
    color: #444 !important;
}
/* =========================================
   9. [READ.JSX 专用] 阅读页样式重写 (覆盖原来的 Dark Mode)
   虽然类名可能还叫 .dark-mode-viewer，但我们要把它改成 "Letter Mode"
   ========================================= */
/* =========================================
   Letter Mode (信纸模式) - 阅读页样式重写
   ========================================= */
/* =========================================
   Letter Mode (信纸模式) - 最终版
   ========================================= */

/* 1. 全局容器与字体 */
.markdown-viewer-content .markdown-body {
    font-family: var(--font-body); /* 使用 EB Garamond */
    font-size: 20px; /* 字号加大，配合手写风 */
    line-height: 2rem; /* 【关键】固定行高，为了配合横线 */
    color: var(--text-main);
    background-color: transparent !important;
}

/* 2. 标题 */
.markdown-viewer-content .markdown-body h1,
.markdown-viewer-content .markdown-body h2,
.markdown-viewer-content .markdown-body h3 {
    font-family: var(--font-serif);
    color: #1a1a1a;
    border-bottom: none;
    margin-top: 2em;
    margin-bottom: 1em;
    font-weight: 600;
}
.markdown-viewer-content .markdown-body h1 { font-size: 2.5em; line-height: 1.2; }
.markdown-viewer-content .markdown-body h2 { font-size: 1.8em; font-style: italic; }

/* =========================================
   【需求 4】信纸横线效果
   只给 p (段落) 和 li (列表) 加横线
   ========================================= */
.markdown-viewer-content .markdown-body p,
.markdown-viewer-content .markdown-body li {
    /* 核心魔法：使用线性渐变画线 */
    background-image: linear-gradient(to bottom, transparent 31px, #d1d5db 31px);
    background-size: 100% 32px; /* 必须和 line-height (2rem = 32px) 严格匹配 */
    background-repeat: repeat-y;
    line-height: 32px; /* 确保文字坐在线上 */
    margin-bottom: 32px; /* 段落间距也作为一个行高 */

    /* 修复长文本溢出 (需求 3b) */
    overflow-wrap: break-word;
    word-wrap: break-word;
    word-break: break-word;
    max-width: 100%;
}

/* =========================================
   【需求 3a】表格样式修复
   ========================================= */
.markdown-viewer-content .markdown-body table {
    border-collapse: collapse; /* 合并边框 */
    width: 100%;
    margin: 32px 0;
    display: table; /* 防止 bytemd 默认的 block 导致宽度失效 */
    overflow-x: auto; /* 允许横向滚动 */
}

.markdown-viewer-content .markdown-body th,
.markdown-viewer-content .markdown-body td {
    border: 1px solid #888; /* 实线边框 */
    padding: 8px 12px;
    font-family: var(--font-sans); /* 表格用无衬线体更清晰 */
    font-size: 16px;
    line-height: 1.5;
}

.markdown-viewer-content .markdown-body th {
    background-color: rgba(0,0,0,0.05);
    font-weight: bold;
}

/* =========================================
   其他元素排除 (不显示横线)
   ========================================= */

/* 代码块 */
/* 1. 外层容器：只在这里设置背景色 (浅灰信纸底色) */
.markdown-viewer-content .markdown-body pre {
    background-color: #F3F4F6 !important; /* 这是代码块整体的底色 */
    border: 1px solid #E5E7EB;
    border-radius: 2px;
    padding: 20px;
    margin: 32px 0;
    font-family: var(--font-mono);
    font-size: 14px;
    line-height: 1.6;
    color: #374151; /* 默认文字颜色 */
    overflow-x: auto;
}

/* 2. 内部元素：强制透明，去除所有“掩膜” */
.markdown-viewer-content .markdown-body pre code,
.markdown-viewer-content .markdown-body pre code span,
.markdown-viewer-content .markdown-body pre .hljs {
    background-color: transparent !important; /* 【关键】强制背景透明 */
    background: transparent !important;       /* 双重保险 */
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 !important;

    /* 3. 强制文字颜色：避免高亮插件把文字变成白色的导致看不见 */
    color: inherit !important;
    text-shadow: none !important;
    font-family: inherit !important;
}


/* 引用块 */
.markdown-viewer-content .markdown-body blockquote {
    margin: 32px 0;
    padding-left: 20px;
    border-left: 3px solid var(--accent-blue);
    color: var(--text-sub);
    font-style: italic;
    background: transparent; /* 引用块内不显示横线，或者你可以去掉这行让它继承 p 的横线 */
}
/* 如果引用块里包含 p，去掉 p 的横线，避免重叠或样式冲突 */
.markdown-viewer-content .markdown-body blockquote p {
    background-image: none;
}

/* 图片 */
.markdown-viewer-content .markdown-body img {
    display: block;
    max-width: 100%; /* 防止图片溢出 */
    margin: 40px auto;
    border: 8px solid #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

/* 公式 (MathJax/Katex) 通常是 div 或 span，不被 p 选中，所以天然没有横线 */
/* .katex-display {
    overflow-x: auto;
    overflow-y: hidden;
    margin: 32px 0;
} */


/* =========================================
   LaTeX (Katex) 样式修复
   ========================================= */

/* 1. 确保 Katex 容器可见 */
.katex {
  font-size: 1.1em !important; /* 公式稍微大一点好读 */
  line-height: 1.2 !important; /* 防止被父级的 32px 行高撑得太开 */
  color: #000 !important;      /* 强制公式为黑色，防止被 inherit 搞成浅色 */
}

/* 2. 块级公式 (Display Mode) */
.katex-display {
  margin: 1em 0 !important;
  overflow-x: auto;
  overflow-y: hidden;
  padding: 10px 0;
}


.katex * {
  border-color: #000 !important;
}

