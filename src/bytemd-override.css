/* =========================================
   1. 核心容器 (Core Container)
   ========================================= */
.bytemd {
  border-radius: 0 !important;
  height: auto !important;
  min-height: 100% !important;
  border: none !important;

  /* 关键：背景透明，让 React 组件里的电影背景透出来 */
  background-color: transparent !important;

  /* 文字：纯黑，像墨水 */
  color: #1a1a1a !important;
  font-family: var(--font-serif) !important; /* 使用衬线体 (Georgia) */
}

/* =========================================
   2. 工具栏 (Toolbar)
   ========================================= */
.bytemd-toolbar {
  /* 极简风格：透明，只有一条极细的灰线 */
  background-color: transparent !important;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
  padding: 8px 12px !important;
  border-radius: 0 !important;
}

/* 工具栏图标按钮 */
.bytemd-toolbar-icon {
  color: #7F8C8D !important; /* 默认灰色 */
  border-radius: 2px !important;
  padding: 6px !important;
  transition: all 0.3s ease;
}

.bytemd-toolbar-icon:hover {
  background-color: rgba(0, 0, 0, 0.05) !important;
  color: #000000 !important; /* 悬浮变纯黑 */
}

.bytemd-toolbar-icon.bytemd-toolbar-icon-active {
  color: #000000 !important;
  background-color: rgba(0, 0, 0, 0.1) !important;
  font-weight: bold;
}

/* =========================================
   3. 布局结构 (Layout)
   ========================================= */
.bytemd-body {
  min-height: 550px !important;
  height: calc(100% - 41px) !important;
}

/* =========================================
   4. 编辑区 (CodeMirror / Editor)
   ========================================= */
.CodeMirror {
  height: 100% !important;
  background: transparent !important;
  /* 编辑字体：打字机风格，而不是代码风格 */
  font-family: 'Courier New', Courier, monospace !important;
  font-size: 15px !important;
  line-height: 1.8 !important;
  color: #111 !important; /* 深黑色文字 */
}

.CodeMirror-scroll {
  padding-bottom: 30px !important;
  height: 100% !important;
  overflow: hidden !important;
  min-height: 0 !important;
}

/* 光标：简单的黑色竖线 */
.CodeMirror-cursor {
  border-left: 1px solid #000 !important;
}

/* 选中文本背景：淡雅的雾霾蓝 */
.CodeMirror-selected {
  background: rgba(44, 62, 80, 0.1) !important;
}

/* =========================================
   5. 预览区 (Markdown Preview)
   ========================================= */
.markdown-body {
  height: 100% !important;
  background-color: transparent !important;
  color: #1a1a1a !important; /* 墨色 */
  font-family: var(--font-serif) !important; /* 乔治亚衬线体 */
  padding: 20px 40px !important;
  font-size: 16px !important;
  line-height: 2 !important; /* 增加行高，阅读感更强 */
}

/* --- Markdown 内部排版：信件风格 --- */

/* 标题：优雅、衬线、斜体 */
.markdown-body h1,
.markdown-body h2,
.markdown-body h3 {
  border-bottom: none !important; /* 去掉原本粗硬的下划线 */
  font-weight: normal !important;
  font-style: italic;
  margin-top: 1.5em !important;
  margin-bottom: 0.8em !important;
  color: #000 !important;
}

.markdown-body h1 {
  font-size: 2.5em !important;
  letter-spacing: -1px;
}

/* 列表 */
.markdown-body ul, .markdown-body ol {
  padding-left: 20px !important;
  color: #34495E !important;
}

/* 链接：不再是蓝色，而是加粗的黑色带下划线 */
.markdown-body a {
  color: #000 !important;
  text-decoration: underline !important;
  text-decoration-color: #999 !important;
  text-underline-offset: 4px;
}

/* 引用块：像旁白或低语 */
.markdown-body blockquote {
  border-left: 3px solid #BDC3C7 !important; /* 浅灰条 */
  color: #7F8C8D !important; /* 浅灰字 */
  background: transparent !important;
  font-family: 'Courier New', monospace !important;
  font-style: italic;
  padding-left: 20px !important;
}

/* 行内代码：打字机样式 */
.markdown-body code {
  background-color: rgba(0,0,0,0.05) !important;
  color: #455A64 !important; /* 深岩灰 */
  font-family: 'Courier New', monospace !important;
  border-radius: 2px !important;
  padding: 2px 6px !important;
  font-size: 0.9em !important;
}

/* 代码块：旧纸张风格 */
.markdown-body pre {
  background-color: #F5F5F0 !important; /* 暖白纸色 */
  border: 1px dashed #BDC3C7; /* 虚线边框 */
  border-radius: 2px !important;
  padding: 20px !important;
}

/* =========================================
   6. 状态栏 (Status Bar)
   ========================================= */
.bytemd-status {
  border-top: 1px solid rgba(0,0,0,0.05) !important;
  background-color: rgba(255,255,255,0.8) !important;
  color: #95A5A6 !important;
  font-family: 'Courier New', monospace !important;
  font-size: 11px !important;
}

/* =========================================
   7. 全屏模式 (Fullscreen) - 营造你描述的意境
   ========================================= */
.bytemd-fullscreen {
  z-index: 1000 !important;
  position: fixed !important;
  top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important;
  height: 100vh !important;
  border: none !important;

  /*
     背景模拟：从阴天的天空(灰蓝) -> 海面(深蓝灰) -> 地面(黑灰)
     这只是 CSS 渐变模拟，实际上 React 组件里的图片会更好看，
     但这里作为兜底或全屏时的沉浸背景。
  */
  background: linear-gradient(
    to bottom,
    #EBF0F3 0%,   /* Sky: 阴天雾霾蓝 */
    #90A4AE 40%,  /* Horizon: 灰度增加 */
    #546E7A 60%,  /* Sea: 深海蓝灰 */
    #263238 90%,  /* Ground: 暗处 */
    #ECEFF1 100%  /* Mask: 底部白色掩膜 */
  ) !important;

  color: #1a1a1a !important;
  transition: all 0.3s ease;
}

.bytemd-fullscreen .bytemd-toolbar {
  background-color: rgba(235, 240, 243, 0.8) !important;
  backdrop-filter: blur(5px);
}

/* 全屏时内容区居中，像一张信纸 */
.bytemd-fullscreen .CodeMirror,
.bytemd-fullscreen .markdown-body {
  max-width: 900px;
  margin: 0 auto;
  background-color: rgba(255, 255, 255, 0.4); /* 微微的白纸感 */
  box-shadow: 0 0 50px rgba(0,0,0,0.1);
  padding: 40px !important;
  min-height: 100vh;
}

/* =========================================
   8. 滚动条隐藏
   ========================================= */
.CodeMirror-vscrollbar,
.CodeMirror-hscrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

/* =========================================
   9. [READ.JSX 专用] 阅读页样式重写 (覆盖原来的 Dark Mode)
   虽然类名可能还叫 .dark-mode-viewer，但我们要把它改成 "Letter Mode"
   ========================================= */
/* =========================================
   Letter Mode (信纸模式) - 阅读页样式重写
   ========================================= */
/* =========================================
   Letter Mode (信纸模式) - 最终版
   ========================================= */

/* 1. 全局容器与字体 */
.markdown-viewer-content .markdown-body {
    font-family: var(--font-body); /* 使用 EB Garamond */
    font-size: 20px; /* 字号加大，配合手写风 */
    line-height: 2rem; /* 【关键】固定行高，为了配合横线 */
    color: var(--text-main);
    background-color: transparent !important;
}

/* 2. 标题 */
.markdown-viewer-content .markdown-body h1,
.markdown-viewer-content .markdown-body h2,
.markdown-viewer-content .markdown-body h3 {
    font-family: var(--font-serif);
    color: #1a1a1a;
    border-bottom: none;
    margin-top: 2em;
    margin-bottom: 1em;
    font-weight: 600;
}
.markdown-viewer-content .markdown-body h1 { font-size: 2.5em; line-height: 1.2; }
.markdown-viewer-content .markdown-body h2 { font-size: 1.8em; font-style: italic; }

/* =========================================
   【需求 4】信纸横线效果
   只给 p (段落) 和 li (列表) 加横线
   ========================================= */
.markdown-viewer-content .markdown-body p,
.markdown-viewer-content .markdown-body li {
    /* 核心魔法：使用线性渐变画线 */
    background-image: linear-gradient(to bottom, transparent 31px, #d1d5db 31px);
    background-size: 100% 32px; /* 必须和 line-height (2rem = 32px) 严格匹配 */
    background-repeat: repeat-y;
    line-height: 32px; /* 确保文字坐在线上 */
    margin-bottom: 32px; /* 段落间距也作为一个行高 */

    /* 修复长文本溢出 (需求 3b) */
    overflow-wrap: break-word;
    word-wrap: break-word;
    word-break: break-word;
    max-width: 100%;
}

/* =========================================
   【需求 3a】表格样式修复
   ========================================= */
.markdown-viewer-content .markdown-body table {
    border-collapse: collapse; /* 合并边框 */
    width: 100%;
    margin: 32px 0;
    display: table; /* 防止 bytemd 默认的 block 导致宽度失效 */
    overflow-x: auto; /* 允许横向滚动 */
}

.markdown-viewer-content .markdown-body th,
.markdown-viewer-content .markdown-body td {
    border: 1px solid #888; /* 实线边框 */
    padding: 8px 12px;
    font-family: var(--font-sans); /* 表格用无衬线体更清晰 */
    font-size: 16px;
    line-height: 1.5;
}

.markdown-viewer-content .markdown-body th {
    background-color: rgba(0,0,0,0.05);
    font-weight: bold;
}

/* =========================================
   其他元素排除 (不显示横线)
   ========================================= */

/* 代码块 */
/* 1. 外层容器：只在这里设置背景色 (浅灰信纸底色) */
.markdown-viewer-content .markdown-body pre {
    background-color: #F3F4F6 !important; /* 这是代码块整体的底色 */
    border: 1px solid #E5E7EB;
    border-radius: 2px;
    padding: 20px;
    margin: 32px 0;
    font-family: var(--font-mono);
    font-size: 14px;
    line-height: 1.6;
    color: #374151; /* 默认文字颜色 */
    overflow-x: auto;
}

/* 2. 内部元素：强制透明，去除所有“掩膜” */
.markdown-viewer-content .markdown-body pre code,
.markdown-viewer-content .markdown-body pre code span,
.markdown-viewer-content .markdown-body pre .hljs {
    background-color: transparent !important; /* 【关键】强制背景透明 */
    background: transparent !important;       /* 双重保险 */
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 !important;

    /* 3. 强制文字颜色：避免高亮插件把文字变成白色的导致看不见 */
    color: inherit !important;
    text-shadow: none !important;
    font-family: inherit !important;
}


/* 引用块 */
.markdown-viewer-content .markdown-body blockquote {
    margin: 32px 0;
    padding-left: 20px;
    border-left: 3px solid var(--accent-blue);
    color: var(--text-sub);
    font-style: italic;
    background: transparent; /* 引用块内不显示横线，或者你可以去掉这行让它继承 p 的横线 */
}
/* 如果引用块里包含 p，去掉 p 的横线，避免重叠或样式冲突 */
.markdown-viewer-content .markdown-body blockquote p {
    background-image: none;
}

/* 图片 */
.markdown-viewer-content .markdown-body img {
    display: block;
    max-width: 100%; /* 防止图片溢出 */
    margin: 40px auto;
    border: 8px solid #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

/* 公式 (MathJax/Katex) 通常是 div 或 span，不被 p 选中，所以天然没有横线 */
.katex-display {
    overflow-x: auto;
    overflow-y: hidden;
    margin: 32px 0;
}
